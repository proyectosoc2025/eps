â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          SOPORTE PARA CONTRASEÃ‘AS EN TEXTO PLANO AGREGADO                â•‘
â•‘                      25 de Noviembre de 2025                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… CAMBIO REALIZADO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

El sistema ahora acepta contraseÃ±as en TEXTO PLANO ademÃ¡s de las encriptadas.
Esto permite crear usuarios directamente en la base de datos sin necesidad
de encriptar la contraseÃ±a previamente.


ğŸ¯ PROBLEMA SOLUCIONADO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ANTES:
  â€¢ Solo se aceptaban contraseÃ±as encriptadas con password_hash()
  â€¢ Si creabas un usuario en la BD con contraseÃ±a "admin123"
  â€¢ No podÃ­as iniciar sesiÃ³n porque el sistema esperaba un hash

AHORA:
  â€¢ Se aceptan contraseÃ±as encriptadas (recomendado)
  â€¢ TambiÃ©n se aceptan contraseÃ±as en texto plano
  â€¢ Puedes crear usuarios directamente en la BD con contraseÃ±a simple
  â€¢ El sistema verifica ambos formatos automÃ¡ticamente


ğŸ”§ CÃ“MO FUNCIONA:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

El sistema ahora verifica la contraseÃ±a en DOS pasos:

1. PRIMERO: Intenta verificar con password_verify() (hash)
   â€¢ Si la contraseÃ±a estÃ¡ encriptada, funciona normalmente
   â€¢ MÃ©todo seguro y recomendado

2. SEGUNDO: Si falla, compara en texto plano
   â€¢ Si la contraseÃ±a en BD es "admin123"
   â€¢ Y el usuario escribe "admin123"
   â€¢ Permite el acceso

CÃ³digo implementado:
```php
// Verificar contraseÃ±a: primero intenta con hash, luego con texto plano
$password_valida = false;
if (password_verify($password, $row['password'])) {
    // ContraseÃ±a encriptada vÃ¡lida
    $password_valida = true;
} elseif ($password === $row['password']) {
    // ContraseÃ±a en texto plano vÃ¡lida
    $password_valida = true;
}
```


ğŸ“Š APLICADO A TODOS LOS ROLES:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ Administradores (tabla: administradores)
âœ“ Doctores (tabla: doctores)
âœ“ Pacientes (tabla: pacientes)


ğŸ’¾ EJEMPLOS DE USO EN BASE DE DATOS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

OPCIÃ“N 1 - ContraseÃ±a en texto plano (SIMPLE):
```sql
INSERT INTO administradores 
(usuario, password, nombres, apellidos, rol, email, fecha_creacion) 
VALUES 
('admin', 'admin123', 'Administrador', 'Sistema', 'Administrador', 
 'admin@hospital.com', NOW());
```
Login: usuario = admin, password = admin123 âœ“


OPCIÃ“N 2 - ContraseÃ±a encriptada (RECOMENDADO):
```sql
-- Primero generar el hash en PHP:
-- password_hash('admin123', PASSWORD_DEFAULT)
-- Resultado: $2y$10$...hash...

INSERT INTO administradores 
(usuario, password, nombres, apellidos, rol, email, fecha_creacion) 
VALUES 
('admin', '$2y$10$...hash...', 'Administrador', 'Sistema', 'Administrador', 
 'admin@hospital.com', NOW());
```
Login: usuario = admin, password = admin123 âœ“


AMBAS OPCIONES FUNCIONAN AHORA âœ“


ğŸ” RECOMENDACIONES DE SEGURIDAD:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ IMPORTANTE:

1. TEXTO PLANO es MENOS SEGURO:
   â€¢ Si alguien accede a la BD, ve las contraseÃ±as
   â€¢ Solo usar para pruebas o desarrollo
   â€¢ NO recomendado para producciÃ³n

2. ENCRIPTADO es MÃS SEGURO:
   â€¢ Nadie puede ver la contraseÃ±a original
   â€¢ Recomendado para producciÃ³n
   â€¢ Usa password_hash() en PHP

3. MEJOR PRÃCTICA:
   â€¢ Crear usuarios desde la interfaz del sistema
   â€¢ El sistema encripta automÃ¡ticamente
   â€¢ Solo usar texto plano para casos especiales


ğŸ“ CÃ“MO CREAR USUARIOS SEGUROS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

MÃ‰TODO 1 - Desde la interfaz (RECOMENDADO):
  1. Iniciar sesiÃ³n como administrador
  2. Ir a "GestiÃ³n Usuarios"
  3. Crear nuevo usuario
  4. El sistema encripta automÃ¡ticamente âœ“

MÃ‰TODO 2 - Script PHP para generar hash:
```php
<?php
// generar_password.php
$password = 'admin123';
$hash = password_hash($password, PASSWORD_DEFAULT);
echo "ContraseÃ±a: $password\n";
echo "Hash: $hash\n";
?>
```
Ejecutar: php generar_password.php
Copiar el hash a la BD

MÃ‰TODO 3 - Directamente en BD (SIMPLE pero menos seguro):
```sql
INSERT INTO administradores (..., password, ...) 
VALUES (..., 'admin123', ...);
```
Ahora funciona, pero menos seguro


ğŸ§ª PRUEBAS:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

PRUEBA 1 - Usuario con contraseÃ±a en texto plano:
```sql
INSERT INTO administradores 
(usuario, password, nombres, apellidos, rol, email, fecha_creacion) 
VALUES 
('test1', 'password123', 'Test', 'Usuario', 'Administrador', 
 'test1@test.com', NOW());
```
Login: test1 / password123 â†’ âœ“ FUNCIONA

PRUEBA 2 - Usuario con contraseÃ±a encriptada:
```sql
-- Hash de "password123"
INSERT INTO administradores 
(usuario, password, nombres, apellidos, rol, email, fecha_creacion) 
VALUES 
('test2', '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 
 'Test', 'Usuario2', 'Administrador', 'test2@test.com', NOW());
```
Login: test2 / password123 â†’ âœ“ FUNCIONA


ğŸ“‹ VERIFICACIÃ“N:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1. Crear usuario en BD con contraseÃ±a en texto plano
2. Ir a: http://localhost/hospitalEPS
3. Ingresar usuario y contraseÃ±a
4. Debe permitir el acceso âœ“


âš ï¸ ADVERTENCIA DE SEGURIDAD:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

CONTRASEÃ‘AS EN TEXTO PLANO:
  âŒ Menos seguro
  âŒ Visible en la base de datos
  âŒ Riesgo si hay acceso no autorizado a BD
  âœ“ Ãštil para desarrollo/pruebas
  âœ“ FÃ¡cil de crear usuarios rÃ¡pidamente

CONTRASEÃ‘AS ENCRIPTADAS:
  âœ“ MÃ¡s seguro
  âœ“ No se puede ver la contraseÃ±a original
  âœ“ Recomendado para producciÃ³n
  âœ“ Protege contra accesos no autorizados
  âŒ Requiere generar hash previamente


ğŸ’¡ RECOMENDACIÃ“N FINAL:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Para DESARROLLO/PRUEBAS:
  â€¢ Usar texto plano estÃ¡ bien
  â€¢ RÃ¡pido y fÃ¡cil de crear usuarios
  â€¢ Ejemplo: password = "admin123"

Para PRODUCCIÃ“N:
  â€¢ SIEMPRE usar contraseÃ±as encriptadas
  â€¢ Crear usuarios desde la interfaz
  â€¢ O usar script para generar hash


ğŸ“ ARCHIVO MODIFICADO:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â€¢ api/login.php


ğŸ”„ COMPATIBILIDAD:
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ“ Usuarios existentes con contraseÃ±as encriptadas siguen funcionando
âœ“ Nuevos usuarios con texto plano ahora funcionan
âœ“ No afecta el funcionamiento actual del sistema
âœ“ Retrocompatible al 100%


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

                    âœ… CAMBIO APLICADO EXITOSAMENTE

  Ahora puedes crear usuarios directamente en la base de datos con
  contraseÃ±as en texto plano y podrÃ¡n iniciar sesiÃ³n sin problemas.

  El sistema verifica automÃ¡ticamente si la contraseÃ±a estÃ¡ encriptada
  o en texto plano, y acepta ambas.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Desarrollador: Jonathan Alexis Rodriguez
Fecha: 25 de Noviembre de 2025
Hora: 11:30 AM

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
